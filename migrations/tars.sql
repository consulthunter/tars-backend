CREATE TABLE "projects" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"name" TEXT NOT NULL,
	"url" TEXT NOT NULL,
	"created_at" DATE NOT NULL,
	"modified_at" DATE NOT NULL,
	"docker" INTEGER NOT NULL UNIQUE,
	"version" TEXT NOT NULL,
	"docker_volume" TEXT NOT NULL,
	PRIMARY KEY("id")
);

CREATE TABLE "available_docker_images" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"name" TEXT NOT NULL,
	"tag" TEXT NOT NULL,
	PRIMARY KEY("id")
);

CREATE TABLE "files" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"project_id" INTEGER NOT NULL,
	"package_name" TEXT NOT NULL UNIQUE,
	"name" TEXT NOT NULL,
	"language" TEXT NOT NULL,
	"path" TEXT NOT NULL,
	PRIMARY KEY("id")
);

CREATE TABLE "location" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"start_lin_no" INTEGER NOT NULL,
	"start_pos" INTEGER NOT NULL,
	"end_lin_no" INTEGER NOT NULL,
	"end_pos" INTEGER NOT NULL,
	PRIMARY KEY("id")
);

CREATE TABLE "package_coverage" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"package_name" TEXT NOT NULL UNIQUE,
	"line_rate" DECIMAL NOT NULL,
	"bracnh_rate" DECIMAL NOT NULL,
	"complexity" INTEGER NOT NULL,
	"name" TEXT NOT NULL,
	PRIMARY KEY("id")
);

CREATE TABLE "classes" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"file_id" INTEGER NOT NULL,
	"name" TEXT NOT NULL,
	"visibility" TEXT NOT NULL,
	"modifiers" TEXT NOT NULL,
	"attributes" TEXT NOT NULL,
	"full_string" TEXT NOT NULL,
	"replacement" TEXT NOT NULL,
	"summary" TEXT NOT NULL,
	"is_test_class" INTEGER NOT NULL,
	"testing_framework" TEXT NOT NULL,
	"location" INTEGER NOT NULL UNIQUE,
	PRIMARY KEY("id")
);

CREATE TABLE "class_coverage" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"class_id" INTEGER NOT NULL UNIQUE,
	"line_rate" DECIMAL NOT NULL,
	"branch_rate" DECIMAL NOT NULL,
	"complexity" INTEGER NOT NULL,
	"name" TEXT NOT NULL,
	PRIMARY KEY("id")
);

CREATE TABLE "methods" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"class_id" INTEGER NOT NULL,
	"name" TEXT NOT NULL,
	"visibility" TEXT NOT NULL,
	"modifiers" TEXT ARRAY NOT NULL,
	"attributes" TEXT ARRAY NOT NULL,
	"full_string" TEXT NOT NULL,
	"replacement" TEXT NOT NULL,
	"summary" TEXT NOT NULL,
	"doc_string" TEXT NOT NULL,
	"is_test_method" BOOLEAN NOT NULL,
	"testing_framework" TEXT,
	"test_type" TEXT,
	"location" INTEGER NOT NULL UNIQUE,
	PRIMARY KEY("id")
);

CREATE TABLE "imports" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"file_id" INTEGER NOT NULL,
	"import_name" TEXT NOT NULL,
	"import_path" TEXT NOT NULL,
	"full_string" TEXT NOT NULL,
	"is_local" BOOLEAN NOT NULL,
	PRIMARY KEY("id")
);

CREATE TABLE "method_coverage" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"method_id" INTEGER NOT NULL UNIQUE,
	"line_rate" DECIMAL NOT NULL,
	"branch_rate" DECIMAL NOT NULL,
	"complexity" INTEGER NOT NULL,
	"name" TEXT NOT NULL,
	PRIMARY KEY("id")
);

CREATE TABLE "functions" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"file_id" INTEGER NOT NULL,
	"name" TEXT NOT NULL,
	"modifiers" TEXT ARRAY NOT NULL,
	"attributes" TEXT ARRAY NOT NULL,
	"full_string" TEXT NOT NULL,
	"replacement" TEXT NOT NULL,
	"summary" TEXT NOT NULL,
	"doc_string" TEXT NOT NULL,
	"is_test" BOOLEAN NOT NULL,
	"testing_framework" TEXT,
	"test_type" TEXT,
	"location" INTEGER NOT NULL UNIQUE,
	PRIMARY KEY("id")
);

CREATE TABLE "test_cases" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"method_id" INTEGER UNIQUE,
	"function_id" INTEGER UNIQUE,
	"is_passing" BOOLEAN NOT NULL,
	"modified_at" DATE NOT NULL,
	"created_at" DATE NOT NULL,
	PRIMARY KEY("id")
);

CREATE TABLE "function_coverage" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"function_id" INTEGER NOT NULL UNIQUE,
	"line_rate" DECIMAL NOT NULL,
	"branch_rate" DECIMAL NOT NULL,
	"complexity" INTEGER NOT NULL,
	"name" TEXT NOT NULL,
	PRIMARY KEY("id")
);

CREATE TABLE "invocations" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"method_id" INTEGER,
	"function_id" INTEGER,
	"definition_method_id" INTEGER UNIQUE,
	"definition_function_id" INTEGER UNIQUE,
	"is_assertion" BOOLEAN NOT NULL,
	"full_string" TEXT NOT NULL,
	PRIMARY KEY("id")
);

CREATE TABLE "properties" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"class_id" INTEGER NOT NULL,
	"name" TEXT NOT NULL,
	"visibility" TEXT NOT NULL,
	"modifiers" TEXT ARRAY NOT NULL,
	"attributes" TEXT ARRAY NOT NULL,
	"full_string" TEXT NOT NULL,
	PRIMARY KEY("id")
);

CREATE TABLE "statements" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"file_id" INTEGER NOT NULL,
	"full_string" TEXT NOT NULL,
	PRIMARY KEY("id")
);

ALTER TABLE "available_docker_images"
ADD FOREIGN KEY("id") REFERENCES "projects"("docker")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "classes"
ADD FOREIGN KEY("location") REFERENCES "location"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "package_coverage"
ADD FOREIGN KEY("package_name") REFERENCES "files"("package_name")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "class_coverage"
ADD FOREIGN KEY("class_id") REFERENCES "classes"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "methods"
ADD FOREIGN KEY("class_id") REFERENCES "classes"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "methods"
ADD FOREIGN KEY("location") REFERENCES "location"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "imports"
ADD FOREIGN KEY("file_id") REFERENCES "files"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "method_coverage"
ADD FOREIGN KEY("id") REFERENCES "methods"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "functions"
ADD FOREIGN KEY("file_id") REFERENCES "files"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "functions"
ADD FOREIGN KEY("location") REFERENCES "location"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "test_cases"
ADD FOREIGN KEY("method_id") REFERENCES "methods"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "test_cases"
ADD FOREIGN KEY("function_id") REFERENCES "functions"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "function_coverage"
ADD FOREIGN KEY("function_id") REFERENCES "functions"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "invocations"
ADD FOREIGN KEY("method_id") REFERENCES "methods"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "invocations"
ADD FOREIGN KEY("function_id") REFERENCES "functions"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "invocations"
ADD FOREIGN KEY("definition_method_id") REFERENCES "methods"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "invocations"
ADD FOREIGN KEY("definition_function_id") REFERENCES "functions"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "properties"
ADD FOREIGN KEY("class_id") REFERENCES "classes"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "files"
ADD FOREIGN KEY("project_id") REFERENCES "projects"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "statements"
ADD FOREIGN KEY("file_id") REFERENCES "files"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "classes"
ADD FOREIGN KEY("file_id") REFERENCES "files"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;